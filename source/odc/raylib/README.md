stolen from schveiguys lib with lazy hacks

dont merge into odc unless someone thought that thru
